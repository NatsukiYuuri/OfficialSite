/*! typescript-cookie v1.0.6 | MIT */const w=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),C=t=>encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent),h=decodeURIComponent,f=t=>(t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent));function T(t){return t=Object.assign({},t),typeof t.expires=="number"&&(t.expires=new Date(Date.now()+t.expires*864e5)),t.expires!=null&&(t.expires=t.expires.toUTCString()),Object.entries(t).filter(([e,o])=>o!=null&&o!==!1).map(([e,o])=>o===!0?`; ${e}`:`; ${e}=${o.split(";")[0]}`).join("")}function A(t,e,o){const i=/(?:^|; )([^=]*)=([^;]*)/g,n={};let r;for(;(r=i.exec(document.cookie))!=null;)try{const a=o(r[1]);if(n[a]=e(r[2],a),t===a)break}catch{}return t!=null?n[t]:n}const D=Object.freeze({decodeName:h,decodeValue:f,encodeName:w,encodeValue:C}),p=Object.freeze({path:"/"});function u(t,e,o=p,{encodeValue:i=C,encodeName:n=w}={}){return document.cookie=`${n(t)}=${i(e,t)}${T(o)}`}function m(t,{decodeValue:e=f,decodeName:o=h}={}){return A(t,e,o)}function S({decodeValue:t=f,decodeName:e=h}={}){return A(void 0,t,e)}function I(t,e=p){u(t,"",Object.assign({},e,{expires:-1}))}function g(t,e){const o={set:function(n,r,a){return u(n,r,Object.assign({},this.attributes,a),{encodeValue:this.converter.write})},get:function(n){if(arguments.length===0)return S(this.converter.read);if(n!=null)return m(n,this.converter.read)},remove:function(n,r){I(n,Object.assign({},this.attributes,r))},withAttributes:function(n){return g(this.converter,Object.assign({},this.attributes,n))},withConverter:function(n){return g(Object.assign({},this.converter,n),this.attributes)}},i={attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}};return Object.create(o,i)}g({read:D.decodeValue,write:D.encodeValue},p);class M{constructor(){this.STAMP_RES_PATH="../assets/res/others/202508event/inkan.png",this.GRACE_TIME=40,this.YEAR=2025,this.Month=7,this.RestDays=[11,14,15],this.Init()}async Init(){const e=await this.PopSetTimeWindowAsync();console.log(e);const o=document.getElementById("calendar-days");if(o){const i=new Date,n={},r=new Date(this.YEAR,this.Month,1).getDay();for(let s=0;s<r;s++){const c=document.createElement("div");c.classList.add("_day","_empty"),o.append(c)}let a=0;const d=new Date(this.YEAR,this.Month+1,0).getDate();for(let s=0;s<d;s++){const c=document.createElement("div");c.classList.add("_day"),o.append(c),c.textContent=(s+1).toString(),this.isActiveDay(s)?a++:c.classList.add("_empty"),n[s+1]=c}const y=new Date(this.YEAR,this.Month+1,0).getDay();for(let s=0;s<7-y-1;s++){const c=document.createElement("div");c.classList.add("_day","_empty"),o.append(c)}const l=this.GetDaysCookie();for(let s=0;s<l.length;s++){const c=l[s],E=document.createElement("img");E.src=this.STAMP_RES_PATH,n[c].append(E)}if(this.isActiveDay(i.getDay())&&this.isWithinMinutes(e,this.GRACE_TIME)){const s=i.getDate();l.includes(s)||l.push(s),this.SetDaysCookie(l);const c=document.createElement("img");c.src=this.STAMP_RES_PATH,n[s].append(c)}this.SettingUserDatasText(e,a,l.length)}}SettingUserDatasText(e,o,i){const n=document.getElementById("login-stamp-card-setting-time-text");n.textContent=e;const r=document.getElementById("login-stamp-card-progress-text");r.textContent=i.toString()+"/"+o.toString()}async PopSetTimeWindowAsync(){const e="referenceTime";return new Promise((o,i)=>{const n=m(e);n==null?(console.log("targetが見つかりません"),document.getElementById("set-time-window-button").addEventListener("click",a=>{const d=document.getElementById("set-time-window-time");if(/^([01]\d|2[0-3]):[0-5]\d$/.test(d.value)){u(e,d.value,{expires:100}),document.getElementById("set-time-window").style.display="none",o(d.value);return}console.log("時間が有効ではありません")})):(document.getElementById("set-time-window").style.display="none",o(n))})}SetDaysCookie(e){u("days",JSON.stringify(e),{expires:100})}GetDaysCookie(){const e=m("days");return e==null?[]:JSON.parse(e)}isWithinMinutes(e,o){const i=new Date;if(console.log("現在："+i.getMonth()+" 設定："+this.Month),i.getMonth()!=this.Month)return!1;const[n,r]=e.split(":").map(Number),a=new Date(i.getFullYear(),i.getMonth(),i.getDate(),n,r);return Math.abs(a.getTime()-i.getTime())<=o*60*1e3}isActiveDay(e){return console.log(e),document.getElementById("test-text").textContent=e.toString(),e==6||e==0?!1:!this.RestDays.includes(e+1)}}new M;
